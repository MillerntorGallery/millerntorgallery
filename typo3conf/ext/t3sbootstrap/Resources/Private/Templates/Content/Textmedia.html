<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" 
	xmlns:t3sbs="http://typo3.org/ns/T3SBS/T3sbootstrap/ViewHelpers" data-namespace-typo3-fluid="true">	
<f:layout name="Default" />
<f:section name="Main">
<f:render partial="Header" arguments="{settings : settings, data : data, class : '' }" />
<f:if condition="{data.bodytext}">
	<f:then>
		<f:if condition="{gallery.position.vertical} == 'below'">
			<f:render section="bodytext" arguments="{_all}" />
			<f:render section="gallery" arguments="{_all}" />
		</f:if>
		<f:if condition="{gallery.position.vertical} == 'above'">
			<f:render section="gallery" arguments="{_all}" />
			<f:render section="bodytext" arguments="{_all}" />
		</f:if>
		<f:if condition="{gallery.position.vertical} == 'intext'">
			<f:if condition="{files}">
				<f:then>
					<f:if condition="{gallery.position.noWrap}">
					<f:then>
						<f:if condition="{files -> f:count()} == 1">
							<f:then>
								<div class="row media-position-{gallery.position.horizontal}">
									<div class="col-md-9{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-push-3')}">
										{data.bodytext -> f:format.html()}
									</div>
									<div class="col-md-3{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-pull-9')}">
										<f:render section="gallery" arguments="{_all}" />
									</div>
								</div>
							</f:then>
							<f:else>
								<f:if condition="{gallery.count.columns} == 1">
									<f:then>
										<div class="row media-position-{gallery.position.horizontal}">
											<div class="col-md-9{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-push-3')}">
												{data.bodytext -> f:format.html()}
											</div>
											<div class="col-md-3{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-pull-9')}">
												<f:render section="gallery" arguments="{_all}" />
											</div>
										</div>	
									</f:then>
									<f:else>
										<f:if condition="{gallery.count.columns} >= 4">
											<f:then>
												<div class="row media-position-{gallery.position.horizontal}">
													<div class="col-md-3{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-push-9')}">
														{data.bodytext -> f:format.html()}
													</div>
													<div class="col-md-9{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-pull-3')}">
														<f:render section="gallery" arguments="{_all}" />
													</div>
												</div>									
											</f:then>
											<f:else>
												<div class="row media-position-{gallery.position.horizontal}">
													<div class="col-md-6{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-push-6')}">
														{data.bodytext -> f:format.html()}
													</div>
													<div class="col-md-6{f:if(condition: '{gallery.position.horizontal} == \'left\'',then: ' col-md-pull-6')}">
														<f:render section="gallery" arguments="{_all}" />
													</div>
												</div>
											</f:else>
										</f:if>
									</f:else>					
								</f:if>
							</f:else>
						</f:if>
					</f:then>
					<f:else>						
						<div class="inlineJs media-position-{gallery.position.horizontal} clearfix">
							<div class="intext-pics pull-{gallery.position.horizontal}" 
								style="margin-{gallery.position.horizontal}: 0">		
								<f:render section="galleryInText" arguments="{_all}" />
							</div>
							<div class="intext-text">		
								{data.bodytext -> f:format.html()}
							</div>
						</div>
					</f:else>
					</f:if>
				</f:then>
				<f:else>
					{data.bodytext -> f:format.html()}
				</f:else>
			</f:if>
		</f:if>
	</f:then>
	<f:else>	
		<f:render section="gallery" arguments="{_all}" />
	</f:else>
</f:if>
</f:section>

<f:section name="galleryInText">
	<f:if condition="{data.imagecols} == 88">
		<f:then>
			<f:if condition="{files -> f:count()} == 1">
				<f:then>
					<f:render section="galleryInText-default" arguments="{_all}" />
				</f:then>
				<f:else>
					<f:render section="carousel" arguments="{_all}" />	
				</f:else>
			</f:if>
		</f:then>
		<f:else>
			<f:render section="galleryInText-default" arguments="{_all}" />
		</f:else>
	</f:if>
</f:section>

<f:section name="galleryInText-default">
	<f:if condition="{gallery.count.columns} == 1">
		<f:then>
			<f:if condition="{gallery.chunk}">
				<f:for each="{gallery.chunk}" as="row" iteration="iterator">
					<div class="oneColumn mr-{iterator.cycle}" 
						style="margin-{f:if(condition: '{gallery.position.horizontal} == \'right\'',then: 'left', else: 'right')}: 15px; margin-bottom: 15px;">	
						<f:for each="{row}" as="media">	
							<f:render section="mediaType" arguments="{_all}" />	
						</f:for>	
					</div>
				</f:for>
			</f:if>
		</f:then>
		<f:else>
			<f:if condition="{gallery.chunk}">
				<f:for each="{gallery.chunk}" as="row" iteration="iterator">
					<div style="margin-{f:if(condition: '{gallery.position.horizontal} == \'right\'',then: 'left', else: 'right')}: 0;" 
						class="row media-row mr-{iterator.cycle}">
						<f:for each="{row}" as="media">	
							<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">
								<f:render section="mediaType" arguments="{_all}" />
							</div>
						</f:for>
					</div>	
				</f:for>
			</f:if>
		</f:else>
	</f:if>
</f:section>

<f:section name="gallery">
	<f:if condition="{data.imagecols} == 88">
		<f:then>
			<f:if condition="{files -> f:count()} == 1">
				<f:then>
					<f:render section="gallery-default" arguments="{_all}" />
				</f:then>
				<f:else>
					<f:render section="carousel" arguments="{_all}" />	
				</f:else>
			</f:if>
		</f:then>
		<f:else>
			<f:render section="gallery-default" arguments="{_all}" />
		</f:else>
	</f:if>
</f:section>

<f:section name="gallery-default">
	<f:if condition="{gallery.count.columns} == 1">
		<f:then>
			<f:if condition="{gallery.chunk}">
				<f:for each="{gallery.chunk}" as="row" iteration="iterator">
					<f:if condition="{gallery.position.noWrap}">
						<f:then>
							<div class="media-row mr-{iterator.cycle}">	
						</f:then>
						<f:else>
							<div class="row media-row mr-{iterator.cycle}">	
								<div class="topOrBottom inlineJs {gallery.mediaClassPosition}">
									<div class="col-md-12">
						</f:else>
					</f:if>	
						<f:for each="{row}" as="media">	
							<f:render section="mediaType" arguments="{_all}" />	
						</f:for>	

						<f:if condition="{gallery.position.noWrap}">
							<f:else>
								</div>
								</div>
							</f:else>
						</f:if>
					</div>	
				</f:for>
			</f:if>
		</f:then>
		<f:else>
			<f:if condition="{gallery.chunk}">
				<f:for each="{gallery.chunk}" as="row" iteration="iterator">
					<div class="row media-row mr-{iterator.cycle}">
						<f:if condition="{gallery.position.noWrap}">
							<f:else>
								<f:if condition="{gallery.mediaClassPosition}">
									<div class="topOrBottom inlineJs {gallery.mediaClassPosition}">	
								</f:if>
							</f:else>
						</f:if>
						<f:for each="{row}" as="media" iteration="i">
							<f:if condition="{gallery.position.horizontal} == 'center'">
								<f:then>
									<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">
								</f:then>
								<f:else>
									<f:if condition="{iterator.isLast}">
										<f:then>
											<f:if condition="{gallery.position.vertical} == 'intext'">
												<f:then>
													<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">
												</f:then>
												<f:else>
													<f:if condition="{gallery.mod}">
														<f:then>
															<f:if condition="{i.isLast}">
																<f:then>
																	<div class="col-sm-{gallery.col-md-last} col-md-{gallery.col-md-last}">	
																</f:then>
																<f:else>
																	<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">	
																</f:else>
															</f:if>
														</f:then>
														<f:else>
															<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">
														</f:else>
													</f:if>													
												</f:else>
											</f:if>
										</f:then>
										<f:else>
											<div class="col-sm-{gallery.col-md} col-md-{gallery.col-md}">	
										</f:else>
									</f:if>
								</f:else>
							</f:if>	
								<f:render section="mediaType" arguments="{_all}" />	
							</div>
						</f:for>
						<f:if condition="{gallery.position.noWrap}">
							<f:else>
								<f:if condition="{gallery.mediaClassPosition}">
									</div>	
								</f:if>
							</f:else>
						</f:if>
					</div>
				</f:for>
			</f:if>
		</f:else>
	</f:if>
</f:section>

<f:section name="carousel">
	<div id="carousel-{data.uid}" class="carousel slide" data-ride="carousel" 
	style="{f:if(condition: '{gallery.position.horizontal} == \'right\'',then: 'margin-left:15px;', else: 'margin-right:20px;')}">
		<!-- Indicators -->
		<ol class="carousel-indicators">
			<f:for each="{files}" as="mediaElement" iteration="iterator">
				<li data-target="#carousel-{data.uid}" data-slide-to="{iterator.index}" class="{f:if(condition:'{iterator.isFirst} == 1',then:'active')}"></li>
			</f:for>
		</ol>
		<!-- Wrapper for slides -->
		<div class="carousel-inner" role="listbox">
			<f:for each="{files}" as="media" iteration="iterator">
				<div class="item{f:if(condition:'{iterator.isFirst} == 1',then:' active')}">
					<f:media
						file="{media}"
						alt="{media.alternative}"
						title="{f:if(condition: '{media.title}',then: '{media.title}')}"		
						width="{f:if(condition: '{data.imagewidth}',then: '{data.imagewidth}', else: '{gallery.width}')}"
						height="{f:if(condition: '{data.imageheight}',then: '{data.imageheight}c')}"
						class="img-responsive carousel-slide"
					/>
				</div>	
			</f:for>
		</div>
		<!-- Schalter -->
		<a class="left carousel-control" href="#carousel-{data.uid}" role="button" data-slide="prev">
		<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span><span class="sr-only">Zur√ºck</span></a>
		<a class="right carousel-control" href="#carousel-{data.uid}" role="button" data-slide="next">
		<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span><span class="sr-only">Weiter</span></a>
	</div>
</f:section>

<f:section name="bodytext">
	<f:if condition="{files}">
		<f:then>
			<div class="media-position-{gallery.position.vertical}">
				{data.bodytext -> f:format.html()}
			</div>
		</f:then>
		<f:else>
			{data.bodytext -> f:format.html()}
		</f:else>
	</f:if>
</f:section>

<f:section name="mediaType">
	<figure class="{f:if(condition: '{gallery.mediaClassCenter}',then: ' {gallery.mediaClassCenter}')}" style="margin-bottom: 10px;{f:if(condition: '{data.imagewidth}',then: ' max-width:{data.imagewidth}px;')}" >
		<f:if condition="{media.type} == 2">
			<f:render section="imageType" arguments="{_all}" />
		</f:if>
		<f:if condition="{media.type} == 4">
			<f:render section="videoType" arguments="{_all}" />
		</f:if>
		<f:if condition="{media.description}">
			<figcaption>{media.description}</figcaption>
		</f:if>
	</figure>
</f:section>

<f:section name="imageType">
	<f:if condition="{media.link}">
		<f:then>
			<f:link.typolink parameter="{media.link}">
				<f:render section="image" arguments="{_all}" />
			</f:link.typolink>
		</f:then>
		<f:else>
			<f:if condition="{data.image_zoom}">
				<f:then>				
					<t3sbs:clickEnlarge image="{media}" 
						configuration="{settings.media.popup}" 
						uid="{data.uid}" lightboxGroup="{settings.media.popup.lightboxGroup}">
						<f:render section="image" arguments="{_all}" />
					</t3sbs:clickEnlarge>
				</f:then>
				<f:else>
					<f:render section="image" arguments="{_all}" />
				</f:else>
			</f:if>
		</f:else>
	</f:if>
</f:section>

<f:section name="videoType">
	<div class="embed-responsive embed-responsive-{settings.video.ratio}">
		<f:media
			file="{media}"
			alt="{media.alternative}"
			title="{media.title}"		
			width="{f:if(condition: '{data.imagewidth}',then: '{data.imagewidth}'}"
			height=""
			class="embed-responsive-item"
		/>
	</div>
</f:section>

<f:section name="image">
	<f:media
		file="{media}"
		alt="{media.alternative}"
		title="{f:if(condition: '{media.title}',then: '{media.title}')}"		
		width="{f:if(condition: '{data.imagewidth}',then: '{data.imagewidth}', else: '{gallery.width}')}"
		height="{f:if(condition: '{data.imageheight}',then: '{data.imageheight}c')}"
		class="img-responsive {f:if(condition: '{gallery.border.enabled}',then: ' border')}{f:if(condition: '{data.tx_t3sbootstrap_imagestyle}',then: ' {data.tx_t3sbootstrap_imagestyle}')}"
		style="{f:if(condition: '{gallery.border.enabled}',then: 'border-width: {gallery.border.width}px;')}{f:if(condition: '{gallery.border.padding}',then: ' padding: {gallery.border.padding}px')}"
	/>	
</f:section>
</html>
